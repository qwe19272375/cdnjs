window.findAndReplaceDOMText=function(){function e(e,n,t,r){var d,i=[],o=function e(n){if(3===n.nodeType)return n.data;var t="";if(n=n.firstChild)for(;t+=e(n),n=n.nextSibling;);return t}(n),a=function(e){var p;if(v=[],"function"!=typeof e){var r=e.nodeType?e:document.createElement(e);p=function(e){var n,t=document.createElement("div");return t.innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),n=t.firstChild,e&&n.appendChild(document.createTextNode(e)),n}}else p=e;return function(e){var n=e.startNode,t=e.endNode,r=e.matchIndex;if(n===t){var d=n;if(0<e.startNodeIndex){var i=document.createTextNode(d.data.substring(0,e.startNodeIndex));d.parentNode.insertBefore(i,d)}var o=p(e.match[0],r);if(d.parentNode.insertBefore(o,d),e.endNodeIndex<d.length){var a=document.createTextNode(d.data.substring(e.endNodeIndex));d.parentNode.insertBefore(a,d)}return d.parentNode.removeChild(d),v.push(function(){var e=o.parentNode;e.insertBefore(o.firstChild,o),e.removeChild(o),e.normalize()}),o}for(var i=document.createTextNode(n.data.substring(0,e.startNodeIndex)),a=document.createTextNode(t.data.substring(e.endNodeIndex)),f=p(n.data.substring(e.startNodeIndex),r),s=[],l=0,u=e.innerNodes.length;l<u;++l){var h=e.innerNodes[l],c=p(h.data,r);h.parentNode.replaceChild(c,h),s.push(c)}var N=p(t.data.substring(0,e.endNodeIndex),r);return n.parentNode.insertBefore(i,n),n.parentNode.insertBefore(f,n),n.parentNode.removeChild(n),t.parentNode.insertBefore(N,t),t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t),v.push(function(){s.unshift(f),s.push(N);for(var e=0,n=s.length;e<n;++e){var t=s[e],r=t.parentNode;r.insertBefore(t.firstChild,t),r.removeChild(t),r.normalize()}}),N}}(t);if(o){if(e.global)for(;d=e.exec(o);)i.push(f(d,r));else d=o.match(e),i.push(f(d,r));i.length&&function(e,n,t){var r,d,i,o,a=[],f=0,s=e,l=n.shift(),u=0;e:for(;;){if(3===s.nodeType&&(!d&&s.length+f>=l[1]?(d=s,o=l[1]-f):r&&a.push(s),!r&&s.length+f>l[0]&&(r=s,i=l[0]-f),f+=s.length),r&&d){if(s=t({startNode:r,startNodeIndex:i,endNode:d,endNodeIndex:o,innerNodes:a,match:l[2],matchIndex:u}),f-=d.length-o,d=r=null,a=[],l=n.shift(),u++,!l)break}else if(s.firstChild||s.nextSibling){s=s.firstChild||s.nextSibling;continue}for(;;){if(s.nextSibling){s=s.nextSibling;break}if(s.parentNode===e)break e;s=s.parentNode}}}(n,i,a)}}function f(e,n){if(n=n||0,!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var t=e.index;if(0<n){var r=e[n];if(!r)throw"Invalid capture group";t+=e[0].indexOf(r),e[0]=r}return[t,t+e[0].length,[e[0]]]}var v;return e.revert=function(){for(var e=0,n=v.length;e<n;++e)v[e]();v=[]},e}();