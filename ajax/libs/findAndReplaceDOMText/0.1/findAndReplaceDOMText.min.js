window.findAndReplaceDOMText=function(){function e(e,n,t){var r,d,o=[],i=function e(n){if(3===n.nodeType)return n.data;var t="";if(n=n.firstChild)for(;t+=e(n),n=n.nextSibling;);return t}(n),a=function(e){var p;if(x=[],"function"!=typeof e){var r=e.nodeType?e:document.createElement(e);p=function(e){var n,t=document.createElement("div");return t.innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),n=t.firstChild,e&&n.appendChild(document.createTextNode(e)),n}}else p=e;return function(e){var n=e.startNode,t=e.endNode,r=e.matchIndex;if(n===t){var d=n;if(0<e.startNodeIndex){var o=document.createTextNode(d.data.substring(0,e.startNodeIndex));d.parentNode.insertBefore(o,d)}var i=p(e.match[0],r);if(d.parentNode.insertBefore(i,d),e.endNodeIndex<d.length){var a=document.createTextNode(d.data.substring(e.endNodeIndex));d.parentNode.insertBefore(a,d)}return d.parentNode.removeChild(d),x.push(function(){var e=i.parentNode;e.insertBefore(i.firstChild,i),e.removeChild(i),e.normalize()}),i}var o=document.createTextNode(n.data.substring(0,e.startNodeIndex)),a=document.createTextNode(t.data.substring(e.endNodeIndex)),f=p(n.data.substring(e.startNodeIndex),r),s=p(t.data.substring(0,e.endNodeIndex),r),l=[];n.parentNode.insertBefore(o,n),n.parentNode.insertBefore(f,n),n.parentNode.removeChild(n),t.parentNode.insertBefore(s,t),t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t);for(var h=0,u=e.innerNodes.length;h<u;++h){var c=e.innerNodes[h],N=p(c.data,r);c.parentNode.replaceChild(N,c),l.push(N)}return x.push(function(){l.unshift(f),l.push(s);for(var e=0,n=l.length;e<n;++e){var t=l[e],r=t.parentNode;r.insertBefore(t.firstChild,t),r.removeChild(t),r.normalize()}}),s}}(t);if(i){if(e.global)for(;r=e.exec(i);){if(!r[0])throw"findAndReplaceDOMText cannot handle zero-length matches";o.push([e.lastIndex-r[0].length,e.lastIndex,r])}else{if(r=i.match(e),d=i.indexOf(r[0]),!r[0])throw"findAndReplaceDOMText cannot handle zero-length matches";o.push([d,d+r[0].length,r])}o.length&&function(e,n,t){var r,d,o,i,a=[],f=0,s=e,l=n.shift(),h=0;e:for(;;){if(3===s.nodeType&&(!d&&s.length+f>=l[1]?(d=s,i=l[1]-f):r&&a.push(s),!r&&s.length+f>l[0]&&(r=s,o=l[0]-f),f+=s.length),r&&d){if(s=t({startNode:r,startNodeIndex:o,endNode:d,endNodeIndex:i,innerNodes:a,match:l[2],matchIndex:h}),f-=d.length-i,d=r=null,a=[],l=n.shift(),h++,!l)break}else if(s.firstChild||s.nextSibling){s=s.firstChild||s.nextSibling;continue}for(;;){if(s.nextSibling){s=s.nextSibling;break}if(s.parentNode===e)break e;s=s.parentNode}}}(n,o,a)}}var x;return e.revert=function(){for(var e=0,n=x.length;e<n;++e)x[e]();x=[]},e}();